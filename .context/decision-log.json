{
  "version": "1.0.0",
  "decisions": [
    {
      "id": "DEC-2025-01-16-STACK",
      "title": "Stack base TypeScript + Express",
      "date": "2025-01-16",
      "context": "Necesitamos fijar un perfil predeterminado para que los agentes sepan qu√© dependencias ejemplificar en el starkit.",
      "decision": "Mantener TypeScript (Node.js 20) con Express m√≠nimo, Jest/Playwright/Pact/k6 para testing, ESLint + Prettier para lint/format y esbuild como build tool.",
      "consequences": [
        "Facilita reemplazo r√°pido por otros frameworks al no introducir dependencias complejas",
        "Documentaci√≥n actualizada en README, dev-docs/context.md y dev-docs/tech-stack-decisions.md",
        "Los consumidores deben actualizar el config si eligen otro stack"
      ],
      "references": [
        "config/tech-stack.json",
        "dev-docs/tech-stack-decisions.md",
        "dev-docs/context.md"
      ]
    },
    {
      "id": "DEC-2025-01-16-SETUP-PHASE-B",
      "title": "Aplicar Fase B del plan de remediaci√≥n del setup",
      "date": "2025-01-16",
      "context": "El auditor report√≥ riesgos de p√©rdida de datos y prerequisitos no verificados en `scripts/setup.sh`.",
      "decision": "Agregar validaci√≥n temprana de prerequisitos, confirmaciones de sobrescritura con soporte `--force` y un prompt para conservar/mover/eliminar `templates/`.",
      "consequences": [
        "Los usuarios ven errores claros antes de que el script copie archivos si falta git/npm/python3/pip/docker-compose",
        "Los repos existentes no se sobrescriben sin confirmaci√≥n expl√≠cita",
        "Se documenta c√≥mo automatizar el flujo desde README y dev-docs/tooling-guide.md"
      ],
      "references": [
        "scripts/setup.sh",
        "README.md#üöÄ-quick-start",
        "dev-docs/setup/setup-sh-remediation-plan.md",
        "dev-docs/tooling-guide.md#5-script-interactivo-scriptssetupsh"
      ]
    },
    {
      "id": "DEC-2025-01-16-SETUP-PHASE-C",
      "title": "Completar C3.1/C3.3 del setup y diferir C3.2",
      "date": "2025-01-16",
      "context": "La auditor√≠a ped√≠a test harness, integridad de contextos y observabilidad; se priorizaron los dos primeros para mantener el starkit simple.",
      "decision": "Agregar harness Bash + helper utc_timestamp/warning docker-compose y documentar que las banderas --verbose/--no-color quedan como mejora opt-in (TASK-015).",
      "consequences": [
        "scripts/setup.sh se valida autom√°ticamente y produce JSON consistente",
        "README/tooling guide/post-adaptation checklist documentan npm run test:setup y SETUP_SH_SKIP_INSTALLS",
        "Observabilidad se traslada al backlog opcional (TASK-015)"
      ],
      "references": [
        "scripts/setup.sh",
        "tests/setup/setup_script.test.sh",
        "dev-docs/setup/setup-sh-remediation-plan.md",
        "dev-docs/setup/setup-sh-remediation-report.md"
      ]
    },
    {
      "id": "DEC-2025-01-16-DB-BLUEPRINT",
      "title": "Blueprint agn√≥stico para TASK-003",
      "date": "2025-01-16",
      "context": "El roadmap exige documentar c√≥mo implementar base de datos y migraciones sin comprometer el car√°cter de starkit.",
      "decision": "Publicar `dev-docs/infrastructure/database-blueprint.md`, enlazarlo desde README/plan/backlog y mantener TASK-003 pendiente hasta que un consumidor adopte el plan.",
      "consequences": [
        "Los equipos tienen una gu√≠a paso a paso sin que el repo arrastre dependencias de DB",
        "TASK-003 referencia expl√≠cita al blueprint y puede moverse a 'En progreso' apenas se seleccione proveedor real",
        "El estado global refleja la deuda de infraestructura como TD-DB-001 para facilitar seguimiento"
      ],
      "references": [
        "dev-docs/infrastructure/database-blueprint.md",
        "README.md#üóÑÔ∏è-blueprint-de-base-de-datos-y-migraciones",
        "dev-docs/task.md#task-003-setup-database-y-migrations",
        "dev-docs/plan.md#fase-3-infrastructure"
      ]
    },
    {
      "id": "DEC-2025-01-16-APP-BLUEPRINT",
      "title": "Blueprint agn√≥stico para TASK-004",
      "date": "2025-01-16",
      "context": "El roadmap requiere un primer caso de uso pero el starkit no debe incluir l√≥gica espec√≠fica; se necesita una gu√≠a reutilizable.",
      "decision": "Crear `dev-docs/application/use-case-blueprint.md`, enlazarlo desde README/plan/task y mantener TASK-004 pendiente hasta que el consumidor seleccione su flujo.",
      "consequences": [
        "Los equipos conocen los artefactos, pruebas y code reviews necesarios antes de implementar su primer handler",
        "Se evita introducir infraestructura o dependencias accidentales en la capa de aplicaci√≥n",
        "La documentaci√≥n de validaci√≥n y el backlog ahora se√±alan expl√≠citamente el blueprint como prerequisito"
      ],
      "references": [
        "dev-docs/application/use-case-blueprint.md",
        "README.md#üß†-blueprint-de-casos-de-uso-y-handlers",
        "dev-docs/task.md#task-004-implementar-primer-use-case",
        "dev-docs/plan.md#fase-2-application-layer",
        "dev-docs/post-adaptation-validation.md"
      ]
    },
    {
      "id": "DEC-2025-01-16-DEPENDABOT-PLAN",
      "title": "Planificar la ejecuci√≥n de Dependabot sin sobre-ingenier√≠a",
      "date": "2025-01-16",
      "context": "El pipeline `npm ci` reporta 19 vulnerabilidades moderadas y no existe `.github/dependabot.yml`; necesitamos priorizar qu√© arreglar dentro del starkit y qu√© dejar al consumidor.",
      "decision": "Crear PLAN_EJECUCION_DEPENDABOT.md, a√±adir TASK-016/TASK-017 y actualizar README/tooling guide/checklists para documentar que configuraremos Dependabot y actualizaremos el package.json ra√≠z antes de delegar nuevas alertas.",
      "consequences": [
        "Hay un documento √∫nico que distingue entre hallazgos cr√≠ticos y mejoras opcionales",
        "El backlog incluye tareas concretas (configuraci√≥n + baseline) sin introducir auto-merge ni herramientas externas",
        "README/dev-docs se√±alan a los consumidores d√≥nde documentar su propia estrategia si difiere"
      ],
      "references": [
        "PLAN_EJECUCION_DEPENDABOT.md",
        "README.md#ü§ñ-plan-de-dependabot",
        "dev-docs/tooling-guide.md#6-dependabot-y-mantenimiento-de-dependencias",
        "dev-docs/task.md#task-016-configurar-dependabot-m√≠nimo",
        "dev-docs/task.md#task-017-actualizar-baseline-de-dependencias",
        "dev-docs/plan.md#programa-de-ejecuci√≥n-dependabot",
        "dev-docs/context.md#estado-de-dependabot-y-escaneo-de-dependencias"
      ]
    },
    {
      "id": "DEC-2025-01-17-DB-STACK",
      "title": "Adoptar PostgreSQL 16 + runner SQL estilo node-pg-migrate",
      "date": "2025-01-17",
      "context": "TASK-003 estaba bloqueada hasta seleccionar un motor y herramienta de migraciones reales para el starkit.",
      "decision": "Configurar servicio `db` (PostgreSQL 16) en docker-compose, exponer scripts `npm run migrate:*` respaldados por `scripts/migrate.ts` (runner SQL compatible con node-pg-migrate), y documentar el uso de `.env` para `DATABASE_URL`/credenciales.",
      "consequences": [
        "El repositorio incluye migraciones bootstrap (`db/migrations/000000000000__bootstrap.sql`) y seeds reproducibles.",
        "`Makefile`/README documentan los comandos `db:up`, `db:reset`, `npm run migrate:up`, `npm run seed`.",
        "tests/integration/db/connection.test.ts` verifica la conexi√≥n y la presencia de la migraci√≥n inicial."
      ],
      "references": [
        "docker-compose.dev.yml",
        "Makefile",
        "db/migrations/README.md",
        "scripts/migrate.ts",
        "scripts/seed.ts",
        "tests/integration/db/connection.test.ts",
        "README.md#üóÑÔ∏è-blueprint-de-base-de-datos-y-migraciones"
      ]
    },
    {
      "id": "DEC-2025-01-17-APP-UC1",
      "title": "Seleccionar RegisterUserAccount como primer use case",
      "date": "2025-01-17",
      "context": "TASK-004 requer√≠a definir qu√© flujo de negocio implementar√≠a la capa de aplicaci√≥n sin perder el alineamiento con el bounded context Identity & Access.",
      "decision": "Adoptar el escenario `RegisterUserAccount`, que recibe un comando con email/nombre/password, invoca al aggregate `User` y persiste mediante un `UserAccountRepository` abstracto mientras publica los eventos recolectados.",
      "consequences": [
        "`dev-docs/task.md` y `dev-docs/plan.md` marcan el avance del use case siguiendo el blueprint.",
        "`.context/project-state.json` refleja que la deuda TD-APP-001 est√° en progreso y detalla el flujo seleccionado.",
        "Los siguientes pasos (DTOs, puertos, handler) quedan delimitados para futuros agentes sin ambig√ºedad."
      ],
      "references": [
        "dev-docs/task.md#task-004-implementar-primer-use-case",
        "dev-docs/plan.md#fase-2-application-layer",
        "dev-docs/domain/ubiquitous-language.md#bounded-context-identity--access",
        ".context/project-state.json"
      ]
    }
  ]
}
